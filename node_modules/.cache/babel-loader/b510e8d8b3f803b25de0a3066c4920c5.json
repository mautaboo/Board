{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nexport function useOnDraw(onDraw) {\n  _s();\n  $btnDescargar = document.querySelector(\"#btnDescargar\");\n  $btnDescargar.addEventListener(\"click\", () => {\n    // Crear un elemento <a>\n    let enlace = document.createElement('a');\n    // El título\n    enlace.download = \"Canvas como imagen.png\";\n    // Convertir la imagen a Base64 y ponerlo en el enlace\n    enlace.href = canvas.toDataURL();\n    // Hacer click en él\n    enlace.click();\n  });\n  const canvasRef = useRef(null);\n  const isDrawingRef = useRef(false);\n  const prevPointRef = useRef(null);\n  const mouseMoveListenerRef = useRef(null);\n  const mouseUpListenerRef = useRef(null);\n  function setCanvasRef(ref) {\n    canvasRef.current = ref;\n  }\n  function onCanvasMouseDown() {\n    isDrawingRef.current = true;\n  }\n  useEffect(() => {\n    function computePointInCanvas(clientX, clientY) {\n      if (canvasRef.current) {\n        const boundingRect = canvasRef.current.getBoundingClientRect();\n        return {\n          x: clientX - boundingRect.left,\n          y: clientY - boundingRect.top\n        };\n      } else {\n        return null;\n      }\n    }\n    function initMouseMoveListener() {\n      const mouseMoveListener = e => {\n        if (isDrawingRef.current && canvasRef.current) {\n          const point = computePointInCanvas(e.clientX, e.clientY);\n          const ctx = canvasRef.current.getContext('2d');\n          if (onDraw) onDraw(ctx, point, prevPointRef.current);\n          prevPointRef.current = point;\n          console.log(point);\n        }\n      };\n      mouseMoveListenerRef.current = mouseMoveListener;\n      window.addEventListener(\"mousemove\", mouseMoveListener);\n    }\n    function initMouseUpListener() {\n      const listener = () => {\n        isDrawingRef.current = false;\n        prevPointRef.current = null;\n      };\n      mouseUpListenerRef.current = listener;\n      window.addEventListener(\"mouseup\", listener);\n    }\n    function cleanup() {\n      if (mouseMoveListenerRef.current) {\n        window.removeEventListener(\"mousemove\", mouseMoveListenerRef.current);\n      }\n      if (mouseUpListenerRef.current) {\n        window.removeEventListener(\"mouseup\", mouseUpListenerRef.current);\n      }\n    }\n    initMouseMoveListener();\n    initMouseUpListener();\n    return () => cleanup();\n  }, [onDraw]);\n  return {\n    setCanvasRef,\n    onCanvasMouseDown\n  };\n}\n_s(useOnDraw, \"yzQlUgpjSmNqxYCWmikAILNmSuw=\");\n;","map":{"version":3,"names":["useEffect","useRef","useOnDraw","onDraw","$btnDescargar","document","querySelector","addEventListener","enlace","createElement","download","href","canvas","toDataURL","click","canvasRef","isDrawingRef","prevPointRef","mouseMoveListenerRef","mouseUpListenerRef","setCanvasRef","ref","current","onCanvasMouseDown","computePointInCanvas","clientX","clientY","boundingRect","getBoundingClientRect","x","left","y","top","initMouseMoveListener","mouseMoveListener","e","point","ctx","getContext","console","log","window","initMouseUpListener","listener","cleanup","removeEventListener"],"sources":["C:/Users/mauri/OneDrive/Documentos/TT/Desarrollo/eboard/src/Components/Pizarron/Hooks.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\n\r\nexport function useOnDraw(onDraw) {\r\n\r\n    $btnDescargar = document.querySelector(\"#btnDescargar\");\r\n\r\n    $btnDescargar.addEventListener(\"click\", () => {\r\n        // Crear un elemento <a>\r\n        let enlace = document.createElement('a');\r\n        // El título\r\n        enlace.download = \"Canvas como imagen.png\";\r\n        // Convertir la imagen a Base64 y ponerlo en el enlace\r\n        enlace.href = canvas.toDataURL();\r\n        // Hacer click en él\r\n        enlace.click();\r\n  });\r\n\r\n    const canvasRef = useRef(null);\r\n    const isDrawingRef = useRef(false);\r\n    const prevPointRef = useRef(null);\r\n\r\n    const mouseMoveListenerRef = useRef(null);\r\n    const mouseUpListenerRef = useRef(null);\r\n\r\n    function setCanvasRef(ref) {\r\n        canvasRef.current = ref;\r\n    }\r\n\r\n    function onCanvasMouseDown() {\r\n        isDrawingRef.current = true;\r\n    }\r\n\r\n    useEffect(() => {\r\n        function computePointInCanvas(clientX, clientY) {\r\n            if (canvasRef.current) {\r\n                const boundingRect = canvasRef.current.getBoundingClientRect();\r\n                return {\r\n                    x: clientX - boundingRect.left,\r\n                    y: clientY - boundingRect.top\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n        function initMouseMoveListener() {\r\n            const mouseMoveListener = (e) => {\r\n                if (isDrawingRef.current && canvasRef.current) {\r\n                    const point = computePointInCanvas(e.clientX, e.clientY);\r\n                    const ctx = canvasRef.current.getContext('2d');\r\n                    if (onDraw) onDraw(ctx, point, prevPointRef.current);\r\n                    prevPointRef.current = point;\r\n                    console.log(point);\r\n                }\r\n            }\r\n            mouseMoveListenerRef.current = mouseMoveListener;\r\n            window.addEventListener(\"mousemove\", mouseMoveListener);\r\n        }\r\n\r\n        function initMouseUpListener() {\r\n            const listener = () => {\r\n                isDrawingRef.current = false;\r\n                prevPointRef.current = null;\r\n            }\r\n            mouseUpListenerRef.current = listener;\r\n            window.addEventListener(\"mouseup\", listener);\r\n        }\r\n\r\n        function cleanup() {\r\n            if (mouseMoveListenerRef.current) {\r\n                window.removeEventListener(\"mousemove\", mouseMoveListenerRef.current);\r\n            }\r\n            if (mouseUpListenerRef.current) {\r\n                window.removeEventListener(\"mouseup\", mouseUpListenerRef.current);\r\n            }\r\n        }\r\n\r\n        initMouseMoveListener();\r\n        initMouseUpListener();\r\n        return () => cleanup();\r\n\r\n    }, [onDraw]);\r\n\r\n    return {\r\n        setCanvasRef,\r\n        onCanvasMouseDown\r\n    }\r\n\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}